# backup_syncer

[English Readme](README_eng.md)

---

## Русский

### Описание

**backup_syncer** — pet-проект для проверки целостности резервных копий и (в будущем) синхронизации файлов между серверами.

Проект состоит из двух независимых модулей:

- **service** — серверный сервис, который собирает информацию о файлах и рассчитывает контрольные суммы
- **checker** — утилита для проверки файлов/результатов и валидации сохранённых данных

В перспективе проект будет расширен до полноценной системы синхронизации между серверами.

---

### Архитектура

```
backup_syncer/
├── service/ # Серверный модуль
└── checker/ # Проверяющий модуль
```

---

### Модуль `service`

Модуль `service` предназначен для запуска на серверах, где хранятся данные.

Основные возможности:

- Рекурсивный обход директорий
- Получение списка файлов, отсортированного по размеру
- Расчёт контрольных сумм:
  - `SHA256`
  - `MD5`
- Параллельная обработка файлов (multiprocessing)
- Автоматическое определение количества физических ядер
- Кросс-платформенная поддержка checksum-утилит:
  - Linux
  - FreeBSD
  - OpenBSD
  - SunOS
  - macOS
- Формирование JSON-отчётов
- Криптографическая подпись результата (`SHA3-512`)

Результат работы сервиса сохраняется в JSON-файл следующего вида:

- список файлов
- контрольные суммы
- ошибки (если были)
- время выполнения
- timestamp запуска
- имя группы
- подпись данных

---

### Конфигурация

Пример `config.py`:

```python
GROUPS = [
    {
        "name": "group1",
        "path": "/data/backups"
    }
]

OUTPUT_DIRECTORY = "/var/lib/backup_syncer/output"

```

### Запуск

Предполагается запуск по крону

---

### Модуль `checker`

Модуль `checker` предназначен для:

* проверки целостности файлов
* проверки контрольных сумм
* проверки подписи данных
* сравнения текущего состояния с ранее сохранёнными результатами

Код модуля активно развивается и предназначен для использования отдельно от сервиса.

---

### Планы на будущее

* синхронизация файлов между серверами
* сравнение состояний разных серверов
* инкрементальные проверки
* удалённое взаимодействие (API / agent-based)
* автоматическое восстановление повреждённых файлов

---
